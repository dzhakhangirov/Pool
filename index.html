<!DOCTYPE html><html><head><meta http-equiv="Content-Type"content="text/html; charset=utf-8"/><title>Babylon.js sample code</title><!--Babylon.js--><script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.6.2/dat.gui.min.js"></script><script src="https://assets.babylonjs.com/generated/Assets.js"></script><script src="https://cdn.babylonjs.com/babylon.js"></script><script src="https://cdn.babylonjs.com/materialsLibrary/babylonjs.materials.min.js"></script><script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.js"></script><script src="https://cdn.babylonjs.com/gui/babylon.gui.min.js"></script><script src="https://cdn.babylonjs.com/materialsLibrary/babylon.waterMaterial.js"></script><style>html,body{overflow:hidden;width:100%;height:100%;margin:0;padding:0;}#renderCanvas{width:100%;height:100%;touch-action:none;}#canvasZone{width:100%;height:100%;}</style></head><body><canvas id="renderCanvas"></canvas><script>var canvas=document.getElementById("renderCanvas");var startRenderLoop=function(engine,canvas){engine.runRenderLoop(function(){if(sceneToRender&&sceneToRender.activeCamera){sceneToRender.render();}});}
var engine=null;var scene=null;var sceneToRender=null;var createDefaultEngine=function(){return new BABYLON.Engine(canvas,true,{preserveDrawingBuffer:true,stencil:true,disableWebGL2Support:false});};var createScene=async function(){var scene=new BABYLON.Scene(engine);scene.clearColor=new BABYLON.Color3(0,0,0);const camera=new BABYLON.ArcRotateCamera("camera",Math.PI/1.0,Math.PI/2.5,30,new BABYLON.Vector3(0,5,0));camera.attachControl(canvas,true);camera.lowerBetaLimit=0.1;camera.upperBetaLimit=2;camera.lowerRadiusLimit=5;camera.upperRadiusLimit=40;camera.lowerBetaLimit=0*Math.PI/2.4;camera.upperBetaLimit=Math.PI/2.0;const light=new BABYLON.HemisphericLight("light",new BABYLON.Vector3(-1,1,-1));const light1=new BABYLON.HemisphericLight("light1",new BABYLON.Vector3(1,1,1));light.intensity=0.5;light1.intensity=0.5;var sotok=50;const skybox=BABYLON.MeshBuilder.CreateBox("skyBox",{size:sotok*4},scene);const skyboxMaterial=new BABYLON.StandardMaterial("skyBox",scene);skyboxMaterial.backFaceCulling=false;skyboxMaterial.reflectionTexture=new BABYLON.CubeTexture("textures/skybox/TropicalSunnyDay",scene);skyboxMaterial.reflectionTexture.coordinatesMode=BABYLON.Texture.SKYBOX_MODE;skyboxMaterial.diffuseColor=new BABYLON.Color3(0,0,0);skyboxMaterial.specularColor=new BABYLON.Color3(0,0,0);skybox.material=skyboxMaterial;const ground_0=BABYLON.MeshBuilder.CreateGround("ground",{height:1.2*sotok,width:1.4*sotok});ground_0.position=new BABYLON.Vector3(0,-2.6,0);const box_0=BABYLON.MeshBuilder.CreateBox("box_0",{height:2,width:2.4,depth:1});box_0.position=new BABYLON.Vector3(-9.3,-1.6,-5.2);const box_1=BABYLON.MeshBuilder.CreateBox("box_1",{height:2,width:2.4,depth:1});box_1.position=new BABYLON.Vector3(-9.3,-1.6,5.2);var myMaterial=new BABYLON.StandardMaterial("myMaterial",scene);myMaterial.diffuseTexture=new BABYLON.Texture("textures/land.jpg",scene);myMaterial.bumpTexture=new BABYLON.Texture("textures/land.png",scene);myMaterial.emissiveColor=new BABYLON.Color3(0,0,0);ground_0.material=myMaterial;box_0.material=myMaterial;box_1.material=myMaterial;var ground_1=BABYLON.Mesh.CreateGround("ground_1",1.5*sotok,0.5*sotok,700,scene,false);ground_1.position=new BABYLON.Vector3(0,-0.7,18);var ground_2=BABYLON.Mesh.CreateGround("ground_2",1.5*sotok,0.5*sotok,700,scene,false);ground_2.position=new BABYLON.Vector3(0,-0.7,-18);var ground_3=BABYLON.Mesh.CreateGround("ground_3",0.575*sotok,0.222*sotok,300,scene,false);ground_3.position=new BABYLON.Vector3(23,-0.7,0);var ground_4=BABYLON.Mesh.CreateGround("ground_3",0.540*sotok,0.222*sotok,300,scene,false);ground_4.position=new BABYLON.Vector3(-24,-0.7,0);var furMaterial=new BABYLON.FurMaterial("fur_S",scene);furMaterial.highLevelFur=false;furMaterial.furLength=0.6;furMaterial.furAngle=Math.PI/6;furMaterial.furColor=new BABYLON.Color3(0,1,0);ground_1.material=furMaterial;ground_2.material=furMaterial;ground_3.material=furMaterial;ground_4.material=furMaterial;var water=new BABYLON.WaterMaterial("water",scene,new BABYLON.Vector2(512,512));water.backFaceCulling=true;water.bumpTexture=new BABYLON.Texture("textures/waterbump.png",scene);water.windForce=1.9;water.waveHeight=0.005;water.bumpHeight=0.1;water.waterColor=new BABYLON.Color3(0.16,0.75,0.83);water.colorBlendFactor=0.5;water.addToRenderList(skybox);let playing=1;let advancedTexture=await BABYLON.GUI.AdvancedDynamicTexture.CreateFullscreenUI("GUI",true,scene);let loadedGUI=advancedTexture.parseFromURLAsync("assets/guiTexture.json");BABYLON.SceneLoader.ImportMesh("","models/","scene.glb",scene,function(newMeshes,particleSystems,skeletons){var pool=newMeshes[0];scene.getMeshByName("Water").material=water;pool.scaling=new BABYLON.Vector3(2,2,2);pool.position=new BABYLON.Vector3(0,-1.8,0);const poolAnim=scene.getAnimationGroupByName("All Animations");poolAnim.start(false,1.0,poolAnim.from,poolAnim.to,true);let image1=advancedTexture.getControlByName("Image1");let image2=advancedTexture.getControlByName("Image2");let image3=advancedTexture.getControlByName("Image3");let image4=advancedTexture.getControlByName("Image4");let image5=advancedTexture.getControlByName("Image5");let image6=advancedTexture.getControlByName("Image6");let slider=advancedTexture.getControlByName("Slider");let textblock=advancedTexture.getControlByName("Textblock");let textblock1=advancedTexture.getControlByName("Textblock1");let button=advancedTexture.getControlByName("Button");let rectangle1=advancedTexture.getControlByName("Rectangle1");button.onPointerOutObservable.add(()=>{document.body.style.cursor=''});button.onPointerEnterObservable.add(()=>{document.body.style.cursor='pointer'});image1.onPointerOutObservable.add(()=>{document.body.style.cursor=''});image1.onPointerEnterObservable.add(()=>{document.body.style.cursor='pointer'});image2.onPointerOutObservable.add(()=>{document.body.style.cursor=''});image2.onPointerEnterObservable.add(()=>{document.body.style.cursor='pointer'});image3.onPointerOutObservable.add(()=>{document.body.style.cursor=''});image3.onPointerEnterObservable.add(()=>{document.body.style.cursor='pointer'});image4.onPointerOutObservable.add(()=>{document.body.style.cursor=''});image4.onPointerEnterObservable.add(()=>{document.body.style.cursor='pointer'});image5.onPointerOutObservable.add(()=>{document.body.style.cursor=''});image5.onPointerEnterObservable.add(()=>{document.body.style.cursor='pointer'});let visibleBlock=1;button.onPointerClickObservable.add(()=>{if(visibleBlock==1){visibleBlock=0;textblock1.isVisible=false;rectangle1.background="#FFFFFF00";}
else{visibleBlock=1;textblock1.isVisible=true;rectangle1.background="#8E949B96";}});slider.onValueChangedObservable.add((value)=>{poolAnim.goToFrame(value);});
let kadr=0;let keyKadr=[60,900,1500,2016];let textKadr=["Земляные работы.\n\n- Дренаж по периметру\n- Укладка геотекстиля\n- Песочная подушка\n- Гравийная подушка\n- Установка стоек\n- Армирование\n- Заливка бетона","Установка каркаса.\n\n- Сборка каркаса\n- Установка накладок\n- Отделка торцов\n- Установка закладных\n- Установка направляющих\n- Клейкая лента на швы","Установка оборудования.\n\n- Установка каркаса\n- Подвод электрики\n- Установка скиммеров\n- Установка форсунок\n- Установка фильтра\n- Установка насоса\n- Обвязка оборудования","Подготовка к заливке.\n\n- Установка бортов\n- Укладка подложки\n- Установка лайнера\n- Частичная заливка\n- Расправить лайнер\n- Прорезание отверстий\n- Установка мембраны\n- Запуск фильтрации"];const textKadrConst=textKadr.slice();scene.onBeforeRenderObservable.add(()=>{if(scene.animationGroups[0].targetedAnimations[0].animation.runtimeAnimations[0].currentFrame<2800){kadr=scene.animationGroups[0].targetedAnimations[0].animation.runtimeAnimations[0].currentFrame;}
else{poolAnim.pause();image3.source="assets/images/png/play.png";playing=2;}
slider.value=kadr;textblock.text=Math.floor(kadr/60);if(kadr>0&&kadr<900){textblock1.text=textKadrConst[0];}
else if(kadr>900&&kadr<1500){textblock1.text=textKadrConst[1];}
else if(kadr>1500&&kadr<2016){textblock1.text=textKadrConst[2];}
else if(kadr>2016&&kadr<2700){textblock1.text=textKadrConst[3];}
else if(kadr>2700){textblock1.text="Установка деревянного бассейна BWT";}});image3.onPointerUpObservable.add(function(){if(playing==1){playing=0;poolAnim.pause();}
else if(playing==0){playing=1;poolAnim.restart();}
else if(playing==2){playing=1;poolAnim.stop();poolAnim.start();}
let kadr=scene.animationGroups[0].targetedAnimations[0].animation.runtimeAnimations[0].currentFrame;});image1.onPointerUpObservable.add(function(){playing=1;poolAnim.stop();poolAnim.start();image3.source="assets/images/png/pause.png";});image5.onPointerUpObservable.add(function(){if(playing<2){playing=2;poolAnim.restart();poolAnim.speedRatio=30;image3.source="assets/images/png/play.png";}});image2.onPointerUpObservable.add(function(){playing=0;poolAnim.speedRatio=1;poolAnim.pause();image3.source="assets/images/png/play.png";n=keyKadr.pop();keyKadr.unshift(n);nt=textKadr.pop();textKadr.unshift(nt);poolAnim.goToFrame(keyKadr[0]);textblock1.text=textKadr[0];});image4.onPointerUpObservable.add(function(){playing=0;poolAnim.speedRatio=1;poolAnim.pause();image3.source="assets/images/png/play.png";m=keyKadr.shift();keyKadr.push(m);mt=textKadr.shift();textKadr.push(mt);poolAnim.goToFrame(keyKadr[0]);textblock1.text=textKadr[0];});image1.onPointerClickObservable.add(function(){image1.source="assets/images/png/tofirstframe_onclick.png";setTimeout(function(){image1.source="assets/images/png/tofirstframe.png";},150);});image5.onPointerClickObservable.add(function(){image5.source="assets/images/png/tolastframe_onclick.png";setTimeout(function(){image5.source="assets/images/png/tolastframe.png";},150);});image3.onPointerClickObservable.add(function(){if(playing==1){image3.source="assets/images/png/pause_onclick.png";setTimeout(function(){image3.source="assets/images/png/play.png";},150);}
else if(playing==0){image3.source="assets/images/png/play_onclick.png";setTimeout(function(){image3.source="assets/images/png/pause.png";},150);}
else if(playing==2){image3.source="assets/images/png/play_onclick.png";setTimeout(function(){image3.source="assets/images/png/pause.png";},150);}});image4.onPointerClickObservable.add(function(){image4.source="assets/images/png/tonext_onclick.png";setTimeout(function(){image4.source="assets/images/png/tonext.png";},150);});image2.onPointerClickObservable.add(function(){image2.source="assets/images/png/toprevious_onclick.png";setTimeout(function(){image2.source="assets/images/png/toprevious.png";},150);});});const house=BABYLON.SceneLoader.ImportMeshAsync("","models/","House.glb",scene).then((result_h)=>{result_h.meshes[0].scaling=new BABYLON.Vector3(1.2,1.2,1.2);result_h.meshes[0].position=new BABYLON.Vector3(0,0,-20);});return scene;};window.initFunction=async function(){var asyncEngineCreation=async function(){try{return createDefaultEngine();}catch(e){console.log("Что то пошло не так, попробуйте позже!");return createDefaultEngine();}}
window.engine=await asyncEngineCreation();if(!engine)throw'Проблема с движком!';startRenderLoop(engine,canvas);window.scene=createScene();};initFunction().then(()=>{scene.then(returnedScene=>{sceneToRender=returnedScene;});});window.addEventListener("resize",function(){engine.resize();});</script></body></html>
